---
author:
  - name: Nathan Potgieter
    affiliation: Stellenbosch University
    address: |
      First line  
      Second line
    email: <19959672@sun.ac.za>
    url: <https://rstudio.com>
  - name: Romain Lesur
    affiliation: Affiliation
title: "MCmarkete: An R package for the Monte Carlo Simulation of Financial Markets"
shorttitle: "**foo**:  A Capitalized Title"
abstract: |
  This work presents __MCmarket__ an R package designed to provide users with the tools to carry out the Monte Carlo simulation of asset markets. The framework set out in the package uses Elliptical copulas to give rise to the correlation structure and the Archmedian Clayton copula to induce left-tail dependence (or dynamic correlations). Various ARIMA + GARCH models can also be called apon to produce mean and varience persistence. __Non technical users will be able to select between X presets to induce varying degrees of market risk without requiring prior knowedge of the underlying statistical techniques.
# at least one keyword must be supplied
keywords: [monte carlo, copula, garch]
links-to-footnotes: true
paged-footnotes: true
bibliography: Tex/ref.bib
output: 
  pagedown::jss_paged:
    self_contained: false
# uncomment this line to produce HTML and PDF in RStudio:
#knit: pagedown::chrome_print
---

# Introduction

In the field of quantitative finance, Monte Carlo simulations have been used extensively for risk management, as well as in the evaluation of portfolio optimisation algorithms. Their unique ability to generate an ensemble of counterfactuals i.e. possible alternative realizations of stochastic processes with identical characteristics, makes them a uniquely powerful tool in aiding decision making in domains dominated by randomness. They are also relatively easy to construct compared to alternative techniques that rely on complex mathematics. Meanwhile, the steady improvement in computer processing power has made the more sophisticated Monte Carlo techniques increasingly viable. The key input to financial market Monte Carlo frameworks is the markets correlation matrix as this greatly effects the potential for diversification and risk management within each counterfactual market.

This work lays out a pre-established framework for performing Monte Carlo simulations of financial asset market returns, with a unique alteration that produces increased left-tail dependence. In other words, the correlation between assets increases during bear markets, and market crashes in particular. This functionality is particularly useful when simulating asset markets since it is a well documented phenomenon that financial returns experience increased co-dependence during turbulent times [@dyamiccorrelation]. The simulated markets will adhere to the user-defined correlation structure. This framework also provides the functionality to induce various degrees of mean and variance persistence. This is accomplished with a high degree of precision by setting the exact parameters of an ARIMA(p,q) + APGARCH(q,p) equation for which the series will adhere.

The aim of developing this package was to provide users with a set of functions that enable them to simulate financial market data with a highly generalizable set of risk factors and minimal knowledge of coding and/or underlying mathematical techniques. Due to the important dynamic correlations experienced within financial markets during crisis periods, the functionality to induce various levels of the left-tail dependence within the market multivariate distribution was also implemented. __PRESETS__

# Methodology

The Monte Carlo framework involves the following 4 steps:

This example generates k periods of returns, for D Assets across N counterfactual markets.

1. Draw a series of k random, uniformly distributed numbers (corresponding to k trading periods), across a set of D variables (or D assets), from a multivariate distribution with a given correlation matrix. 
    + This is accomplished using Euclidean copulas (Gaussian or t-copula) to induce a correlation structure, as well as the Archmediean Clayton copula to introduce left-tail dependence. This can easily be done using R's copula package [@copula]. 
    + Tawn's (1988) theorem states that a linear weighted combination of copulas is its own unique copula. Therefore, by weighting the random draws obtained from a multivariate Archmedian copula with those from a Clayton copula, a hybrid copula with a given correlation structure and enhanced left-tail dependence is created. 
2. Convert the univariate distributions from being uniformly distributed into something that more resembles the distribution of asset returns. For example one could convert them into normal, student-t or skewed-generalized t distributions. 
    + Practicily this is done the same way one would convert p-values into test statistics using the dnorm(), dt() and dsgt() functions respectively [@baser; @sgt].
    + Technically this is accomplished via the inversion of the chosen cumulative distribution function (CDF).
3. Induce mean and variance persistence to the series, by plugging in the previously simulated series into an ARMA(p,q) + GARCH(q,p) equation as the i.i.d innovations.
    + If the parameters are set accordingly the resulting series should possess the volatility clustering observed in empirical asset returns. 
4. The final step is to repeat the first 3 steps N times to generate an ensemble of asset markets, each with the same risk characteristics but different realisation.

# Examples

Simulating 500 periods across an ensemble of 20 markets with 20 assets with high variance persistence, high market risk and 4 non-overlapping clusters.

```{r example 1}
# Generating a 20 by 20 correlation matrix with 4 non-overlapping clusters
corr <- gen_corr(D = 20, Clusters = "non-overlapping", Num_Clusters = 4) %>% ggcorrplot::ggcorrplot()

# Simulating markets
mc_market(corr, 
          N = 20, # Number of ensembles/counterfactuals
          k = 500, # Number of periods
          mv_dist = "t", # Student-t copula chosen for the part of the multivariate distribution that ahdears to the correlation structure. 
          mv_df = 3, # Degrees of freedom for student-t copula
          left_cop_weight = 0.25, # weight
          left_cop_param = 5,
          
          
          )

```



```{r}
```




## Code formatting

You should use **Pandoc**'s [markdown]{.proglang} but you also can use $\LaTeX$ commands:

* [Java]{.proglang} or $\proglang{Java}$ 
* **plyr**, [plyr]{.pkg} or $\pkg{plyr}$
* `print("abc")` or $\code{print("abc")}$

# [R]{.proglang} code

Can be inserted in regular [R Markdown]{.proglang} blocks.

```{r}
x <- 1:10
x
```

# Render the document

If you use the option `self_contained: false` (see line \#22 of this `Rmd` file), don't click on the `Knit` button in RStudio. Use instead the **xaringan** [@R-xaringan] RStudio add-in _Infinite Moon Reader_.

# References {-}

```{r, include=FALSE}
knitr::write_bib(c(.packages(), 'pagedown', 'xaringan'), 'index.bib')
```
